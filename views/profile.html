<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Profile | Magic Eden</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/profile.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
   
 <!-- Header -->
<header class="header">
    <div class="container">
        <div class="navbar">
            <div class="logo">
                <i class="fas fa-gem"></i>
                <span>Magic Eden</span>
            </div>
            
            <!-- Hamburger Icon for Mobile (hidden on desktop) -->
            <div class="hamburger" id="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
            
            <!-- Navigation Menu - This will be centered on desktop -->
            <div class="nav-menu" id="navMenu">
                <!-- Main Navigation Links - Centered -->
                <div class="nav-center">
                    <a href="/" class="nav-link">Marketplace</a>
                    <a href="/profile" class="nav-link active">My Profile</a>
                    <a href="#" class="nav-link" onclick="showNFTsTab(event)">My NFTs</a>
                    <a href="/activity" class="nav-link">Activity</a>
                </div>
                
                <!-- User Info - Right aligned -->
                <div class="nav-right">
                    <div class="user-info" id="profileHeader">
                        <!-- Filled by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

    <!-- Main Profile Content -->
    <main class="profile-main">
        <div class="container">
            <!-- Profile Header -->
            <div class="profile-header">
                <div class="profile-avatar">
                    <div class="avatar-icon">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="profile-info">
                        <h1 id="profileName">Loading...</h1>
                        <p id="profileEmail">Loading...</p>
                        <div class="profile-stats">
                            <span class="stat"><i class="fas fa-gem"></i> <span id="nftsOwned">0</span> NFTs</span>
                            <span class="stat"><i class="fas fa-wallet"></i> <span id="walletBalance">0</span> WETH</span>
                            <span class="stat"><i class="fas fa-calendar"></i> Member since <span id="joinDate">...</span></span>
                        </div>
                    </div>
                </div>
                
                <div class="profile-actions">
                    <button class="btn btn-primary" onclick="window.location.href='/create-nft'">
                        <i class="fas fa-plus"></i> Create NFT
                    </button>
                    <button class="btn" onclick="window.location.href='/add-eth'">
                        <i class="fas fa-coins"></i> Add Funds
                    </button>
                    <button class="btn" onclick="editProfile()">
                        <i class="fas fa-edit"></i> Edit Profile
                    </button>
                </div>
            </div>

            <!-- Tabs -->
            <div class="profile-tabs">
                <button class="profile-tab active" onclick="showProfileTab('nfts')">
                    <i class="fas fa-gem"></i> My NFTs
                </button>
                <button class="profile-tab" onclick="showProfileTab('imported')">
                    <i class="fas fa-download"></i> Imported NFTs
                </button>
                <button class="profile-tab" onclick="showProfileTab('activity')">
                    <i class="fas fa-history"></i> Activity
                </button>
                <button class="profile-tab" onclick="showProfileTab('collections')">
                    <i class="fas fa-layer-group"></i> Collections
                </button>
                <button class="profile-tab" onclick="showProfileTab('settings')">
                    <i class="fas fa-cog"></i> Settings
                </button>
            </div>

            <!-- My NFTs Tab -->
            <div id="nftsTab" class="profile-content active">
                <h2>My NFTs</h2>
                <div class="nfts-grid" id="userNFTsGrid">
                    <div class="loading">Loading your NFTs...</div>
                </div>
            </div>

            <!-- Imported NFTs Tab -->
            <div id="importedTab" class="profile-content">
                <div class="imported-header">
                    <h2><i class="fas fa-download"></i> Imported NFT Collection</h2>
                    <p class="imported-subtitle">Import NFTs from your wallet or other marketplaces for trading</p>
                </div>
                
                <!-- Imported Wallet Balance -->
                
                
                <!-- Import Section -->
                <div class="import-section">
                    <h3><i class="fas fa-download"></i> Import NFTs</h3>
                    <div class="import-options">
                        <button class="import-btn wallet-import" onclick="showWalletImportModal()">
                            <i class="fas fa-wallet"></i>
                            <span>Import from Wallet</span>
                            <small>Scan your wallet for NFTs</small>
                        </button>
                        
                        <button class="import-btn marketplace-import" onclick="showMarketplaceImportModal()">
                            <i class="fas fa-store"></i>
                            <span>Import from Marketplace</span>
                            <small>OpenSea, Blur, etc.</small>
                        </button>
                        
                        <button class="import-btn manual-import" onclick="showManualImportModal()">
                            <i class="fas fa-plus-circle"></i>
                            <span>Manual Import</span>
                            <small>Enter contract address + token ID</small>
                        </button>
                    </div>
                </div>
                
                <!-- Imported NFTs Grid -->
                <div class="imported-nfts-section">
                    <div class="imported-nfts-header">
                        <h3><i class="fas fa-images"></i> Your Imported NFTs</h3>
                        <div class="imported-nfts-actions">
                            <span class="nft-count" id="importedNFTCount">0 items</span>
                            <button class="refresh-btn" onclick="loadImportedNFTs()">
                                <i class="fas fa-sync-alt"></i> Refresh
                            </button>
                        </div>
                    </div>
                    
                    <div class="imported-nfts-grid" id="importedNFTsGrid">
                        <div class="loading-state">
                            <i class="fas fa-spinner fa-spin"></i> Loading imported NFTs...
                        </div>
                    </div>
                </div>
                
                <!-- Imported Marketplace Stats -->
                <div class="imported-stats">
                    <div class="stat-card">
                        <i class="fas fa-chart-line"></i>
                        <div class="stat-info">
                            <span class="stat-label">Total Volume</span>
                            <span class="stat-value" id="totalVolume">0 ETH</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-exchange-alt"></i>
                        <div class="stat-info">
                            <span class="stat-label">Total Trades</span>
                            <span class="stat-value" id="totalTrades">0</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-users"></i>
                        <div class="stat-info">
                            <span class="stat-label">Active Listings</span>
                            <span class="stat-value" id="activeListings">0</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Activity Tab -->
            <div id="activityTab" class="profile-content">
                <h2>Recent Activity</h2>
                <div class="activity-list" id="activityList">
                    <div class="loading">Loading activity...</div>
                </div>
            </div>

            <!-- Collections Tab -->
            <div id="collectionsTab" class="profile-content">
                <h2>My Collections</h2>
                <div class="collections-grid" id="collectionsGrid">
                    <div class="empty-state">
                        <i class="fas fa-layer-group"></i>
                        <p>You haven't created any collections yet</p>
                        <a href="/create-collection" class="btn btn-primary">Create Collection</a>
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div id="settingsTab" class="profile-content">
                <h2>Account Settings</h2>
                <div class="settings-form">
                    <div class="form-group">
                        <label for="settingsEmail">Email Address</label>
                        <input type="email" id="settingsEmail" readonly>
                    </div>
                    
                    <div class="form-group">
                        <label for="settingsName">Display Name</label>
                        <input type="text" id="settingsName" placeholder="Enter your display name">
                    </div>
                    
                    <div class="form-group">
                        <label for="settingsBio">Bio</label>
                        <textarea id="settingsBio" placeholder="Tell us about yourself" rows="4"></textarea>
                    </div>
                    
                    <div class="form-actions">
                        <button class="btn btn-primary" onclick="saveProfile()">Save Changes</button>
                        <button class="btn" onclick="resetPassword()">Change Password</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <div class="logo">
                        <i class="fas fa-gem"></i>
                        <span>Magic Eden</span>
                    </div>
                    <p>Â© 2024 Magic Eden. All rights reserved.</p>
                </div>
                <div class="footer-section">
                    <a href="/"><i class="fas fa-store"></i> Marketplace</a>
                    <a href="/admin" id="adminLink" style="display:none"><i class="fas fa-cog"></i> Admin</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Wallet Import Modal -->
    <div id="walletImportModal" class="modal">
        <div class="modal-content import-modal">
            <div class="modal-header">
                <h3><i class="fas fa-wallet"></i> Import from Wallet</h3>
                <button class="close-modal" onclick="closeModal('walletImportModal')">&times;</button>
            </div>
            <div class="modal-body">
                <p>Connect your wallet to scan for NFTs</p>
                
                <div class="wallet-connect-options">
                    <button class="wallet-option" onclick="connectMetaMask()">
                        <i class="fab fa-metamask"></i>
                        <span>MetaMask</span>
                    </button>
                    <button class="wallet-option" onclick="connectWalletConnect()">
                        <i class="fas fa-link"></i>
                        <span>WalletConnect</span>
                    </button>
                </div>
                
                <div id="walletStatus" class="wallet-status"></div>
                
                <div class="import-progress" id="importProgress" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                    </div>
                    <span id="progressText">Scanning wallet...</span>
                </div>
                
                <div class="found-nfts" id="foundNFTs" style="display: none;">
                    <h4>Found NFTs:</h4>
                    <div class="found-nfts-grid" id="foundNFTsGrid"></div>
                    
                    <div class="modal-actions">
                        <button class="btn btn-primary" onclick="importSelectedNFTs()">
                            Import Selected
                        </button>
                        <button class="btn" onclick="closeModal('walletImportModal')">
                            Cancel
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Marketplace Import Modal -->
    <div id="marketplaceImportModal" class="modal">
        <div class="modal-content import-modal">
            <div class="modal-header">
                <h3><i class="fas fa-store"></i> Import from Marketplace</h3>
                <button class="close-modal" onclick="closeModal('marketplaceImportModal')">&times;</button>
            </div>
            <div class="modal-body">
                <p>Enter your wallet address to fetch NFTs from other marketplaces</p>
                
                <div class="form-group">
                    <label for="marketplaceWallet">Wallet Address</label>
                    <input type="text" id="marketplaceWallet" placeholder="0x...">
                </div>
                
                <div class="marketplace-options">
                    <label class="checkbox-label">
                        <input type="checkbox" value="opensea" checked> OpenSea
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" value="blur"> Blur
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" value="looksrare"> LooksRare
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" value="Foundation"> Foundation
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" value="Rarible"> Rarible
                    </label>
                </div>
                
                <button class="btn btn-primary" onclick="fetchFromMarketplaces()">
                    Fetch NFTs
                </button>
                
                <div id="marketplaceResults" style="display: none;">
                    <h4>Available to Import:</h4>
                    <div class="found-nfts-grid" id="marketplaceNFTsGrid"></div>
                    
                    <div class="modal-actions">
                        <button class="btn btn-primary" onclick="importMarketplaceNFTs()">
                            Import Selected
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Manual Import Modal -->
    <div id="manualImportModal" class="modal">
        <div class="modal-content import-modal">
            <div class="modal-header">
                <h3><i class="fas fa-plus-circle"></i> Manual Import</h3>
                <button class="close-modal" onclick="closeModal('manualImportModal')">&times;</button>
            </div>
            <div class="modal-body">
                <p>Enter NFT details manually</p>
                
                <div class="form-group">
                    <label for="manualContract">Contract Address</label>
                    <input type="text" id="manualContract" placeholder="0x...">
                </div>
                
                <div class="form-group">
                    <label for="manualTokenId">Token ID</label>
                    <input type="text" id="manualTokenId" placeholder="123">
                </div>
                
                <div class="form-group">
                    <label for="manualName">NFT Name (optional)</label>
                    <input type="text" id="manualName" placeholder="My Awesome NFT">
                </div>
                
                <div class="form-group">
                    <label for="manualImage">Image URL (optional)</label>
                    <input type="text" id="manualImage" placeholder="https://...">
                </div>
                
                <button class="btn btn-primary" onclick="importManualNFT()">
                    Import NFT
                </button>
            </div>
        </div>
    </div>

    <!-- Imported NFT Details Modal -->
    <div id="importedNFTModal" class="modal">
        <div class="modal-content nft-detail-modal">
            <div class="modal-header">
                <h3 id="importedNFTName">NFT Details</h3>
                <button class="close-modal" onclick="closeModal('importedNFTModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="nft-detail-image" id="importedNFTImage"></div>
                
                <div class="nft-detail-info">
                    <p><strong>Collection:</strong> <span id="importedNFTCollection"></span></p>
                    <p><strong>Token ID:</strong> <span id="importedNFTTokenId"></span></p>
                    <p><strong>Imported From:</strong> <span id="importedNFTSource"></span></p>
                    <p><strong>Owner:</strong> <span id="importedNFTOwner"></span></p>
                </div>
                
                <div class="nft-detail-actions">
                    <button class="btn btn-primary" onclick="showSellImportedNFT()">
                        <i class="fas fa-tag"></i> Sell
                    </button>
                    <button class="btn" onclick="showTransferImportedNFT()">
                        <i class="fas fa-paper-plane"></i> Transfer
                    </button>
                    <button class="btn btn-danger" onclick="removeImportedNFT()">
                        <i class="fas fa-trash"></i> Remove
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Sell Imported NFT Modal -->
    <div id="sellImportedNFTModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>List Imported NFT for Sale</h3>
                <button class="close-modal" onclick="closeModal('sellImportedNFTModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="sellPrice">Price (SIM)</label>
                    <input type="number" id="sellPrice" min="0.01" step="0.01" placeholder="0.00">
                </div>
                
                <div class="form-group">
                    <label for="sellDuration">Listing Duration</label>
                    <select id="sellDuration">
                        <option value="1">1 day</option>
                        <option value="3">3 days</option>
                        <option value="7" selected>7 days</option>
                        <option value="30">30 days</option>
                    </select>
                </div>
                
                <div class="modal-actions">
                    <button class="btn btn-primary" onclick="confirmImportedListing()">
                        List for Sale
                    </button>
                    <button class="btn" onclick="closeModal('sellImportedNFTModal')">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Funds Modal -->
    <div id="addFundsModal" class="modal">
        <div class="modal-content">
            <h3><i class="fas fa-coins"></i> Add Funds to Wallet</h3>
            <p>Add WETH to your wallet to purchase NFTs</p>
            <div class="form-group">
                <label for="fundAmount">Amount (WETH)</label>
                <input type="number" id="fundAmount" min="0.01" step="0.01" value="1.0" placeholder="0.00">
            </div>
            <div class="modal-actions">
                <button class="btn btn-primary" onclick="confirmAddFunds()">Add Funds</button>
                <button class="btn" onclick="closeModal('addFundsModal')">Cancel</button>
            </div>
        </div>
    </div>

    <!-- JavaScript Files -->
    <script src="/js/db.js"></script> 
    <script src="/js/app.js"></script>
    <script src="/js/profile.js"></script>
    
</body>
</html>